\newcommand{\begin}[1]{\csname #1\endcsname}
\newcommand{\end}[1]{\csname end#1\endcsname}
\newcommand{\newif}[1]{\expandafter\newcommand\expandafter{\csname if#1\endcsname}{\if{#1}}\expandafter\newcommand\expandafter{\csname #1true\endcsname}{\true{#1}}\expandafter\newcommand\expandafter{\csname #1false\endcsname}{\false{#1}}\csname #1false\endcsname}

\newif{mmode}
\newcommand{\(}{<math xmlns='http://www.w3.org/1998/Math/MathML' display="inline"><mrow>\mmodetrue}
\newcommand{\[}{\par<math xmlns='http://www.w3.org/1998/Math/MathML' display="block"><mrow>\mmodetrue}
\newcommand{\]}{</mrow></math>\mmodefalse\par}

\newif{array}
\newcommand{\amporcol}{\ifarray </mtd><mtd>\else &amp;\fi}
\newenvironment{array}[1][]{\ifmmode <mrow><mtable #1><mtr><mtd>\arraytrue\fi}{\arrayfalse</mtd></mtr></mtable></mrow>}
\newenvironment{matrix}{\array[rowspacing="0.5ex"]}{\endarray}
\newenvironment{pmatrix}{\left(\begin{matrix}}{\end{matrix}\right)}
\newenvironment{bmatrix}{\left[\begin{matrix}}{\end{matrix}\right]}
\newenvironment{Bmatrix}{\left\lbrace\begin{matrix}}{\end{matrix}\right\rbrace}
\newenvironment{vmatrix}{\left\lvert\begin{matrix}}{\end{matrix}\right\rvert}
\newenvironment{Vmatrix}{\left\lVert\begin{matrix}}{\end{matrix}\right\rVert}

\newenvironment{smallmatrix}{<mstyle scriptlevel="2">\matrix}{\endmatrix</mstyle>}

\newenvironment{cases}{<mrow>\left\lbrace\array[columnalign="left left"]}{\endarray</mrow>}
\newenvironment{aligned}{\array[columnalign="right left right left right left right left right left" columnspacing="0em"]}{\endarray}
\newenvironment{gathered}{\array[rowspacing="1.0ex"]}{\endarray}
\newenvironment{split}{\array[columnalign="right left right left right left right left right left" columnspacing="0em"]}{\endarray}

\newenvironment{itemize}{\def\item{\def\item{</li><li>}}<ul><li>}{</li></ul>}
\newenvironment{enumerate}{\def\item{\def\item{</li><li>}}<ol><li>}{</li></ol>}

\newcommand{\section}[1]{\refstepcounter{section}<h1>\thesection\ #1</h1>}
\newcommand{\subsection}[1]{\refstepcounter{subsection}<h2>\thesubsection\   #1</h2>}
\newcommand{\subsubsection}[1]{\refstepcounter{subsubsection}<h3>\thesubsubsection\   #1</h3>}

\newcounter{section}
\newcounter{subsection}
\newcounter{subsubsection}

\newcommand{\newline}{\ifmmode\ifarray </mtd></mtr><mtr><mtd>\fi\else<br />\fi}
\newcommand{\par}{</p><p>}
\newcommand{\emph}[1]{<i>#1</i>}
\newcommand{\textbf}[1]{<strong>#1</strong>}
\newcommand{\"}[1]{&#1uml;}
\newcommand{\`}[1]{&#1grave;}
\newcommand{\'}[1]{&#1acute;}
\newcommand{\^}[1]{&#1circ;}
\newcommand{\~}[1]{&#1tilde;}
\newcommand{\c}[1]{&#1cedil;}
\newcommand{\mathbb}[1]{&#1opf;}
\newcommand{\mathcal}[1]{&#1scr;}
\newcommand{\mathfrak}[1]{&#1fr;}
% Not sure why this works, but it does ...
\newcommand{\ }{ }


\def\parensize{stretchy="false"}
\newcommand{\mathop}[2][]{\ifmmode<mo #1>#2</mo>\else #2\fi}
\newcommand{\mathnum}[2][]{\ifmmode<mn #1>#2</mn>\else #2\fi}
\newcommand{\mathchar}[2][]{\ifmmode<mi #1>#2</mi>\else #2\fi}
\newcommand{\mathparen}[1]{\expandafter\mathop\expandafter[\parensize]{#1}}
\newcommand{\left}[1]{\def\parensize{} #1\def\parensize{stretchy="false"}}
\newcommand{\right}[1]{\def\parensize{} #1\def\parensize{stretchy="false"}}
\newcommand{\big}[1]{\def\parensize{minsize="1.2em" maxsize="1.2em"} #1\def\parensize{}}
\newcommand{\Big}[1]{\def\parensize{minsize="1.8em" maxsize="1.8em"} #1\def\parensize{}}
\newcommand{\bigg}[1]{\def\parensize{minsize="2.4em" maxsize="2.4em"} #1\def\parensize{}}
\newcommand{\Bigg}[1]{\def\parensize{minsize="3em" maxsize="3em"} #1\def\parensize{}}



\newcommand{\text}[2][]{\ifmmode<mtext #1>\mmodefalse #2\mmodetrue</mtext>\else #2\fi}
\newcommand{\frac}[3][]{<mfrac #1><mrow>#2</mrow><mrow>#3</mrow></mfrac>}

\newcommand{\sqrt}[1]{<msqrt>#1</msqrt>}
\newcommand{\root}[2]{<mroot><mrow>#1</mrow><mrow>#2</mrow></mroot>}

\newcommand{\!}{<mspace width="-.5em" />}
\newcommand{\negspace}{\!}
\newcommand{\,}{<mspace width="1em" />}
\newcommand{\thinspace}{\,}
\newcommand{\:}{<mspace width="1em" />}
\newcommand{\medspace}{\:}
\newcommand{\;}{<mspace width="1em" />}
\newcommand{\thickspace}{\;}
\newcommand{\quad}{<mspace width="1em" />}
\newcommand{\qquad}{<mspace width="1em" />}

\newcommand{\ae}{&aelig;}
\newcommand{\AE}{&AElig;}
\newcommand{\oe}{&oelig;}
\newcommand{\OE}{&OElig;}
\newcommand{\aa}{&aring;}
\newcommand{\AA}{&Aring;}
\newcommand{\o}{&oslash;}
\newcommand{\O}{&Oslash;}
\newcommand{\ss}{&szlig;}

\newcommand{\dag}{&dagger;}
\newcommand{\ddag}{&Dagger;}
\newcommand{\S}{&sect;}
\newcommand{\P}{&para;}
\newcommand{\copyright}{&copy;}
\newcommand{\pounds}{&pound;}

\newcommand{\aleph}{\mathchar{&alefsym;}}

\newcommand{\wp}{\mathchar{&weierp;}}
\newcommand{\Re}{\mathchar{&real;}}
\newcommand{\Im}{\mathchar{&image;}}
\newcommand{\surd}{\mathchar{&radic;}}
\newcommand{\angle}{\mathchar{&ang;}}
\newcommand{\partial}{\mathchar{&part;}}
\newcommand{\infty}{\mathchar{&infin;}}
\newcommand{\clubsuit}{\mathchar{&clubs;}}
\newcommand{\diamondsuit}{\mathchar{&diams;}}
\newcommand{\heartsuit}{\mathchar{&hearts;}}
\newcommand{\spadesuit}{\mathchar{&spades;}}
\newcommand{\cdot}{\mathchar{&sdot;}}
\newcommand{\vartheta}{\mathchar{&thetasym;}}
\newcommand{\varpi}{\mathchar{&piv;}}
\newcommand{\dots}{\mathchar{&hellip;}}
\newcommand{\in}{\mathchar{&isin;}}
\newcommand{\to}{\mathchar{&rarr;}}
\newcommand{\approx}{\mathchar{&asymp;}}
\newcommand{\propto}{\mathchar{&prop;}}
\newcommand{\neq}{\mathop{&ne;}}
\newcommand{\neg}{\mathop{&not;}}
\newcommand{\wedge}{\mathop{&and;}}
\newcommand{\vee}{\mathop{&or;}}
\newcommand{\supset}{\mathop{&sup;}}
\newcommand{\subset}{\mathop{&sub;}}
\newcommand{\emptyset}{\mathchar{&empty;}}
\newcommand{\pm}{\mathchar{&plusm;}}
\newcommand{\implies}{\mathop{&rArr;}}

\newcommand{\prime}{\mathchar{&prime;}}
\newcommand{\nabla}{\mathchar{&nabla;}}
\newcommand{\forall}{\mathchar{&forall;}}
\newcommand{\times}{\mathop{&times;}}
\newcommand{\notin}{\mathop{&notin;}}
\newcommand{\ni}{\mathop{&ni;}}
\newcommand{\prod}{\mathop{&prod;}}
\newcommand{\sum}{\mathop{&sum;}}
\newcommand{\ast}{\mathop{&ast;}}
\newcommand{\equiv}{\mathop{&equiv;}}
\newcommand{\sim}{\mathop{&sim;}}
\newcommand{\oplus}{\mathchar{&oplus;}}
\newcommand{\cap}{\mathop{&cap;}}
\newcommand{\cup}{\mathop{&cup;}}
\newcommand{\rfloor}{\mathop{&rfloor;}}
\newcommand{\euro}{\mathchar{&euro;}}
\newcommand{\int}{\mathop{&Integral;}}
\newcommand{\cong}{\mathop{&cong;}}
\newcommand{\ne}{\mathop{&ne;}}
\newcommand{\le}{\mathop{&le;}}
\newcommand{\ge}{\mathop{&ge;}}
\newcommand{\gt}{\mathop{&gt;}}
\newcommand{\lt}{\mathop{&lt;}}
\newcommand{\otimes}{\mathop{&otimes;}}
\newcommand{\perp}{\mathop{&perp;}}
\newcommand{\alpha}{\mathchar{&alpha;}}
\newcommand{\beta}{\mathchar{&beta;}}
\newcommand{\gamma}{\mathchar{&gamma;}}
\newcommand{\delta}{\mathchar{&delta;}}
\newcommand{\epsilon}{\mathchar{&epsilon;}}
\newcommand{\zeta}{\mathchar{&zeta;}}
\newcommand{\eta}{\mathchar{&eta;}}
\newcommand{\theta}{\mathchar{&theta;}}
\newcommand{\iota}{\mathchar{&iota;}}
\newcommand{\kappa}{\mathchar{&kappa;}}
\newcommand{\lambda}{\mathchar{&lambda;}}
\newcommand{\mu}{\mathchar{&mu;}}
\newcommand{\nu}{\mathchar{&nu;}}
\newcommand{\xi}{\mathchar{&xi;}}
\newcommand{\omicron}{\mathchar{&omicron;}}
\newcommand{\pi}{\mathchar{&pi;}}
\newcommand{\rho}{\mathchar{&rho;}}
\newcommand{\sigma}{\mathchar{&sigma;}}
\newcommand{\tau}{\mathchar{&tau;}}
\newcommand{\upsilon}{\mathchar{&upsilon;}}
\newcommand{\phi}{\mathchar{&phi;}}
\newcommand{\chi}{\mathchar{&chi;}}
\newcommand{\psi}{\mathchar{&psi;}}
\newcommand{\omega}{\mathchar{&omega;}}

\newcommand{\lvert}{\mathparen{&VerticalBar;}}
\newcommand{\rvert}{\mathparen{&VerticalBar;}}
\newcommand{\lVert}{\mathparen{&DoubleVerticalBar;}}
\newcommand{\rVert}{\mathparen{&DoubleVerticalBar;}}

\newcommand{\lbrace}{\mathparen{&#123;}}
\newcommand{\rbrace}{\mathparen{&#125;}}
\newcommand{\lbracket}{\mathparen{&#91;}}
\newcommand{\rbracket}{\mathparen{&#93;}}
